{% extends 'base.html' %}

{% block content %}
  <div class="flex flex-col gap-4">
    <form action="/vehicles/" method="post" class="flex flex-col max-w-screen-sm gap-4">
      <div>
        <div class="rounded-full border-2 border-blue-300 py-2 px-4 w-max">
          2022 Toyota RAV4 Hybrid XLE
        </div>
      </div>

      {% csrf_token %}
      <label class="flex flex-col gap-2">
        <span>VIN</span>
        <input type="text" name="vin" value="JTME6RFV0ND522512" readonly>
      </label>
      <div class="flex flex-col gap-2 rounded bg-gray-100 p-2">
        {% for message in ai_messages %}
          <div class="flex flex-col gap-2 bg-white shadow p-2">
            <div class="text-gray-500">{{ message.role|capfirst }}</div>
            <div class="text-gray-700">{{ message.content }}</div>
            <input type="hidden" name="messages[{{ forloop.counter0 }}].role" value="{{ message.role }}" />
            <input type="hidden" name="messages[{{ forloop.counter0 }}].content" value="{{ message.content }}" />
          </div>
          {% if forloop.last %}
            <input type="hidden" name="messages[{{ forloop.counter }}].role" value="user" />
            <input type="text" name="messages[{{ forloop.counter }}].content" placeholder="E.g.: How much will my car be worth in 2 years?" />
          {% endif %}
        {% endfor %}
        {% if not ai_messages %}
          <input type="hidden" name="messages[0].role" value="user" />
          <input type="text" name="messages[0].content" placeholder="E.g.: How much will my car be worth in 2 years?" />
        {% endif %}

      </div>
      <input class="blue-btn" type="submit" value="Submit">
    </form>
  </div>
{% endblock %}
